---
title: Reconnaissance notes
---

## Info gathering
```bash
whois <domain>                              # Domain registrar info
```

## Port scanning
```bash
nmap -sS -Pn -p 1-1000 <ip>                 # Fast TCP port scan
nmap -sV -sC -p 80,443 <ip>                 # Port service discovery 
```

## Network host discovering
```bash
netdiscover -i <net-interface>              # Passive/active ARP scan
arp-scan -l                                 # Fast ARP scan
```

## DNS records gathering
Good results gives `msf auxiliary/gather/enum_dns` but it is worth checking out other tools as the results may vary.

```bash
# Types: ANY, A, TXT, AXFR (zone transfer), MS, NS, CNAME
dig <type> <domain> @<dns-ip>     
dnsrecon -d <domain> -a -n <dns-ip>
nslookup <domain>                   
host <domain>  
```

## Subdomains / vhost discovering
**NOTE**
There are situations where there is no DNS server. Then you have to brute force simply routing to the target ip manually (using the proxy parameter). Probably all sub-domains will then respond with code 200. Our correct one may have a slightly different body or different response code.

**DNS server bruteforcing** 
```bash
gobuster dns -d <domain> -r <dns-server> -w <wordlist>
```

**Bruteforcing with wfuzz**
```bash    
wfuzz
    -u http://FUZZ.url.com
    -w <wordlist>
    -H "Header: value"                      # Extra headers
    -p <target-ip>:80:HTTP                  # Proxy config
    -c                                      # Output with colors
```

**Bruteforcing with ffuf**
```bash
ffuf
    -u http://FUZZ.url.com
    -w <wordlist>
    -H "Header: value"                      # Extra headers
    -b "Cookie=value;"                      # Extra cookies
    -x http://<target-ip>:80                # Proxy config
    -timeout <seconds>                      # HTTP request timeout
    -ac                                     # Auto-calibrate filtering
```

**VHOSTs discovering** (works even without DNS service)
```bash
gobuster vhost -u <url> -w <wordlist>   
```

## Google dorks
[List of interesting dorks for pentesters.](https://www.exploit-db.com/google-hacking-database)

```
"search phrase"                             # Search exact phrase
filetype:pdf                                # Search filetype == pdf
site:my.site.com                            # Limit to this site
-site:my.site.com                           # Exclude this site
intitle:MyTitle                             # With specific phrase in title
inurl:example                               # With specific phrase in URL
```

## Other search engines
- [ViewDNS](https://viewdns.info/)
- [Threat Intelligence Platform](https://threatintelligenceplatform.com/)
- [Censys](https://search.censys.io/)
- [Shodan](https://www.shodan.io/)
- [Crt.sh](https://crt.sh/)

## Recon-NG
```bash
recon-ng -w <workspace>                     # Start with :workspace loaded

# Recon-ng command line
workspaces create <workspace>               # Create workspace
db schema                                   # Show db
db insert domains                           # Add domain
dashboard                                   # Summary of collected data
show <table>                                # Show table content

marketplace
    search <keyword>                        # Search for module by keyword
    info <module>                           # Get info about module
    install <module>                        # Install module
    remove <module>                         # Uninstall module

modules search                              # List installed modules
modules load <module>                       # Load module to memory
CTRL + C                                    # Unload module
options list                                # List module's options
options set <option> <value>                # Set module's option
info                                        # Get full module's info
run                                         # Execute module
```
