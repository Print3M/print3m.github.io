---
title: XSS notes
---

## DOM-based XSS
### Sources
```javascript
window.location
window.location.hash
window.location.search
window.location.href
window.location.pathname # In some cases
document.URL
document.documentURI
document.baseURI
document.referrer
URL.search
URL.searchParams.get(param)
input.value

// TBD: Cookies
```
### Sinks
#### URL injection
```javascript
window.location.href = x
window.location.assign(x)
window.location.replace(x)
document.domain = x
```

#### DOM injection
```javascript
element.innerHTML = x
element.outerHTML = x
element.insertAdjacentHTML = x
window.write(x)
document.writeln(x)
```

#### Attribute injection
```javascript
el.setAttribute(attr, x)
el.setAttribute('href', x)
el.setAttribute('src', x)
element.onevent = x
el.style.cssText = x
```

#### Code injection
```javascript
eval(x)
Function(x)
setTimeout(x)
setInterval(x)
setImmediate(x)
execCommand(x)
execScript(x)
```

#### Open redirect
```javascript
history.go(-1)
history.pushState(x)
history.replaceState(x)
```