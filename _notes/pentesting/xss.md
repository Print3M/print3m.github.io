---
title: XSS notes
---

- [1. DOM-based XSS](#1-dom-based-xss)
  - [1.1. Sources](#11-sources)
  - [1.2. Sinks](#12-sinks)

## 1. DOM-based XSS

### 1.1. Sources

```javascript
window.location
window.location.hash
window.location.search
window.location.href
window.location.pathname # In some cases
document.URL
document.documentURI
document.baseURI
document.referrer
URL.search
URL.searchParams.get(param)
input.value

// TBD: Cookies
```

### 1.2. Sinks

#### 1.2.1. URL injection

```javascript
window.location.href = x
window.location.assign(x)
window.location.replace(x)
document.domain = x
```

#### 1.2.2. DOM injection

```javascript
element.innerHTML = x
element.outerHTML = x
element.insertAdjacentHTML = x
window.write(x)
document.writeln(x)
```

#### 1.2.3. Attribute injection

```javascript
el.setAttribute(attr, x)
el.setAttribute('href', x)
el.setAttribute('src', x)
element.onevent = x
el.style.cssText = x
```

#### 1.2.4. Code injection

```javascript
eval(x)
Function(x)
setTimeout(x)
setInterval(x)
setImmediate(x)
execCommand(x)
execScript(x)
```

#### 1.2.5. Open redirect

```javascript
history.go(-1)
history.pushState(x)
history.replaceState(x)
```
